(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[93],{3281:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>b});var l=t(5155),i=t(2115),n=t(3008),r=t(9946);let a=(0,r.A)("mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),c=(0,r.A)("file-up",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);var d=t(7924),o=t(4847),x=t(285),u=t(2523),h=t(5127),m=t(4838),v=t(7313);let j=e=>{let{pdfUrl:s,invoiceNumber:t}=e,[n,r]=i.useState(null);return i.useEffect(()=>{if(!s)return void r(null);let e=!1;return fetch(s,{method:"HEAD"}).then(s=>{e||r(s.ok)}).catch(()=>{e||r(!1)}),()=>{e=!0}},[s]),(0,l.jsxs)("div",{className:"border rounded-lg bg-white h-full flex flex-col shadow-sm w-full max-w-full",children:[(0,l.jsx)("div",{className:"p-4 border-b font-semibold",children:"Invoice PDF Preview"}),(0,l.jsx)("div",{className:"flex-1 flex items-center justify-center bg-gray-50",children:s?!1===n?(0,l.jsx)("span",{className:"text-muted-foreground text-center",children:"No invoice attached"}):!0===n?(0,l.jsx)("iframe",{src:s,title:t?"Invoice ".concat(t," PDF"):"Invoice PDF",className:"w-full h-full min-h-[400px]"}):(0,l.jsx)("span",{className:"text-muted-foreground text-center",children:"Loading PDF..."}):(0,l.jsx)("span",{className:"text-muted-foreground text-center",children:"Select an invoice to preview its PDF"})})]})};var p=t(7986),f=t(6906),y=t(9811),g=t(6950),N=t(171),w=t(6695);function b(){var e,s,t,r,b,A;let[C,k]=i.useState(""),[S,I]=i.useState([]),[M,P]=i.useState([]),[D,T]=i.useState([]),[$,_]=i.useState([]),[E,F]=i.useState("all"),[L,R]=i.useState(null),[B,H]=i.useState(!1),O=(e,s)=>{R(t=>t?{...t,[e]:s}:t)},U=i.useMemo(()=>Array.from(new Set((null!==N.r&&void 0!==N.r?N.r:[]).map(e=>e.store).filter(Boolean))),[]),q=i.useMemo(()=>Array.from(new Set(N.r.map(e=>e.status))),[]),z=i.useMemo(()=>Array.from(new Set(N.r.map(e=>e.invoiceType))),[]),Q=i.useMemo(()=>N.r.filter(e=>{if("archived"===E&&!e.archived||"deleted"===E&&!e.deleted||"all"===E&&(e.archived||e.deleted))return!1;let s=e.invoiceNumber.toLowerCase().includes(C.toLowerCase())||e.store.toLowerCase().includes(C.toLowerCase())||e.supplier.toLowerCase().includes(C.toLowerCase()),t=!S.length||S.includes(e.store),l=!M.length||M.includes(e.supplier),i=!D.length||D.includes(e.status),n=!$.length||$.includes(e.invoiceType);return s&&t&&l&&i&&n}),[E,C,S,M,D,$]),V=Array.from(new Set(N.r.map(e=>e.supplier))),X=N.r.filter(e=>!e.archived&&!e.deleted).length,G=N.r.filter(e=>e.archived).length,Z=N.r.filter(e=>e.deleted).length;return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold",children:"Purchases"}),(0,l.jsx)(o.U,{})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6 gap-4 flex-wrap",children:[(0,l.jsx)(v.tU,{value:E,onValueChange:F,className:"flex-1 min-w-[320px]",children:(0,l.jsxs)(v.j7,{children:[(0,l.jsxs)(v.Xi,{value:"all",children:["All Invoices (",X,")"]}),(0,l.jsxs)(v.Xi,{value:"archived",children:["Archived (",G,")"]}),(0,l.jsxs)(v.Xi,{value:"deleted",children:["Deleted (",Z,")"]})]})}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("span",{className:"text-muted-foreground text-sm flex items-center gap-1",children:[(0,l.jsx)(a,{className:"h-4 w-4"})," invoices@franchiseai.com"]}),(0,l.jsxs)(x.$,{variant:"default",className:"ml-2 flex items-center gap-2",children:[(0,l.jsx)(c,{className:"h-4 w-4"})," Upload Invoice"]})]})]}),(0,l.jsx)(w.Zp,{className:"border shadow-sm",children:(0,l.jsx)(w.Wu,{className:"p-0",children:(0,l.jsxs)("div",{className:"flex h-full w-full",children:[(0,l.jsxs)("div",{className:"flex flex-col w-[400px] min-w-[280px] max-w-[480px] border-r bg-white h-full transition-all duration-300",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("h2",{className:"text-lg font-medium",children:"Filters"}),(0,l.jsx)("div",{className:"flex items-center gap-2",children:(0,l.jsx)(x.$,{variant:"secondary",onClick:()=>{I([]),P([]),T([]),_([])},children:"Reset Filters"})})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,l.jsxs)(m.rI,{children:[(0,l.jsx)(m.ty,{asChild:!0,children:(0,l.jsx)(x.$,{variant:"outline",className:"flex items-center justify-center px-2 py-1 text-sm",children:"Stores"})}),(0,l.jsxs)(m.SQ,{className:"w-56",children:[(0,l.jsx)(m._2,{onClick:()=>I([]),children:"All Stores"}),(0,l.jsx)(m.mB,{}),U.map(e=>(0,l.jsx)(m.hO,{checked:S.includes(e),onClick:()=>{S.includes(e)?I(S.filter(s=>s!==e)):I([...S,e])},children:e},e))]})]}),(0,l.jsxs)(m.rI,{children:[(0,l.jsx)(m.ty,{asChild:!0,children:(0,l.jsx)(x.$,{variant:"outline",className:"flex items-center justify-center px-2 py-1 text-sm",children:"Suppliers"})}),(0,l.jsxs)(m.SQ,{className:"w-56",children:[(0,l.jsx)(m._2,{onClick:()=>P([]),children:"All Suppliers"}),(0,l.jsx)(m.mB,{}),V.map(e=>(0,l.jsx)(m.hO,{checked:M.includes(e),onClick:()=>{M.includes(e)?P(M.filter(s=>s!==e)):P([...M,e])},children:e},e))]})]}),(0,l.jsxs)(m.rI,{children:[(0,l.jsx)(m.ty,{asChild:!0,children:(0,l.jsx)(x.$,{variant:"outline",className:"flex items-center justify-center px-2 py-1 text-sm",children:"Statuses"})}),(0,l.jsxs)(m.SQ,{className:"w-56",children:[(0,l.jsx)(m._2,{onClick:()=>T([]),children:"All Statuses"}),(0,l.jsx)(m.mB,{}),q.map(e=>(0,l.jsx)(m.hO,{checked:D.includes(e),onClick:()=>{D.includes(e)?T(D.filter(s=>s!==e)):T([...D,e])},children:e},e))]})]}),(0,l.jsxs)(m.rI,{children:[(0,l.jsx)(m.ty,{asChild:!0,children:(0,l.jsx)(x.$,{variant:"outline",className:"flex items-center justify-center px-2 py-1 text-sm",children:"Types"})}),(0,l.jsxs)(m.SQ,{className:"w-56",children:[(0,l.jsx)(m._2,{onClick:()=>_([]),children:"All Types"}),(0,l.jsx)(m.mB,{}),z.map(e=>(0,l.jsx)(m.hO,{checked:$.includes(e),onClick:()=>{$.includes(e)?_($.filter(s=>s!==e)):_([...$,e])},children:e},e))]})]})]}),(0,l.jsx)("div",{className:"flex items-center mb-6 gap-4 flex-wrap",children:(0,l.jsxs)("div",{className:"relative flex-1 min-w-[240px]",children:[(0,l.jsx)(d.A,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),(0,l.jsx)(u.p,{placeholder:"Search invoices...",className:"pl-8",value:C,onChange:e=>k(e.target.value)})]})}),(0,l.jsxs)(h.XI,{children:[(0,l.jsx)(h.A0,{children:(0,l.jsxs)(h.Hj,{children:[(0,l.jsx)(h.nd,{children:"Supplier Contact"}),(0,l.jsx)(h.nd,{children:"Date"}),(0,l.jsx)(h.nd,{children:"Amount (\xa3)"}),(0,l.jsx)(h.nd,{children:"Status"})]})}),(0,l.jsx)(h.BF,{children:0===Q.length?(0,l.jsx)(h.Hj,{children:(0,l.jsx)(h.nA,{colSpan:4,className:"text-center py-6 text-muted-foreground",children:"No invoices found matching your filters"})}):Q.map(e=>(0,l.jsxs)(h.Hj,{className:e.archived?"opacity-70 cursor-pointer":"cursor-pointer",onClick:()=>R(e),style:{userSelect:"none"},children:[(0,l.jsx)(h.nA,{children:e.supplier}),(0,l.jsx)(h.nA,{children:(0,n.GP)(e.date,"dd/MM/yyyy")}),(0,l.jsxs)(h.nA,{children:["\xa3",e.total.toFixed(2)]}),(0,l.jsx)(h.nA,{children:(0,l.jsx)("span",{className:function(e){switch(e){case"AI Processed":return"text-green-600 bg-green-50 px-2 py-1 rounded-full text-xs font-medium";case"Pending AI":return"text-yellow-600 bg-yellow-50 px-2 py-1 rounded-full text-xs font-medium";case"Needs Human Review":return"text-red-600 bg-red-50 px-2 py-1 rounded-full text-xs font-medium";case"Duplicate?":return"text-purple-600 bg-purple-50 px-2 py-1 rounded-full text-xs font-medium";default:return"text-gray-600 bg-gray-50 px-2 py-1 rounded-full text-xs font-medium"}}(e.status),children:e.status})})]},e.id))})]})]}),(0,l.jsx)("div",{className:"flex-1 flex flex-col h-full bg-[#ffffff] p-6 overflow-auto transition-all duration-300",children:L?(0,l.jsxs)("div",{className:"max-w-3xl w-full mx-auto bg-white rounded-xl shadow p-8",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("h2",{className:"text-2xl font-bold",children:["Invoice #",L.invoiceNumber]}),(0,l.jsxs)("div",{className:"text-muted-foreground text-sm",children:["View the details of invoice #",L.invoiceNumber]})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(x.$,{variant:B?"secondary":"outline",size:"sm",onClick:()=>H(e=>!e),children:B?"Cancel":"Edit"}),(0,l.jsx)(x.$,{variant:"outline",size:"sm",children:"Actions"}),(0,l.jsx)(x.$,{variant:"ghost",size:"sm",onClick:()=>{R(null),H(!1)},children:"Back to list"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-6 mb-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:"Invoice Number"}),(0,l.jsx)("div",{className:"font-medium",children:L.invoiceNumber})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:"Date"}),B?(0,l.jsx)(u.p,{type:"date",value:(0,n.GP)(L.date,"yyyy-MM-dd"),onChange:e=>O("date",new Date(e.target.value))}):(0,l.jsx)("div",{className:"font-medium",children:(0,n.GP)(L.date,"dd MMM yyyy")})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:"Status"}),(0,l.jsx)("span",{className:"inline-block rounded px-2 py-1 text-xs font-semibold bg-green-100 text-green-700",children:L.status})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:"Store"}),B?(0,l.jsx)(u.p,{value:L.store,onChange:e=>O("store",e.target.value)}):(0,l.jsx)("div",{className:"font-medium",children:L.store})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:"Supplier"}),B?(0,l.jsx)(u.p,{value:L.supplier,onChange:e=>O("supplier",e.target.value)}):(0,l.jsx)("div",{className:"font-medium",children:L.supplier})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:"Invoice Type"}),B?(0,l.jsx)(u.p,{value:L.invoiceType,onChange:e=>O("invoiceType",e.target.value)}):(0,l.jsx)("div",{className:"font-medium",children:L.invoiceType})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:"Account Code"}),B?(0,l.jsx)(u.p,{value:L.accountCode,onChange:e=>O("accountCode",e.target.value)}):(0,l.jsx)("div",{className:"font-medium",children:L.accountCode})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:"VAT Rate (%)"}),B?(0,l.jsx)(u.p,{value:L.vatRate,onChange:e=>O("vatRate",Number(e.target.value))}):(0,l.jsxs)("div",{className:"font-medium",children:[L.vatRate,"%"]})]})]}),(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsx)(j,{pdfUrl:"pdf"===L.previewType?"/invoice-previews/".concat(L.previewUrl):void 0,invoiceNumber:L.invoiceNumber})}),(0,l.jsx)(p.A,{lineItems:null!=(e=L.lineItems)?e:[],setLineItems:B?e=>{"function"==typeof e?R(s=>{var t;if(!s)return s;let l=e(null!=(t=s.lineItems)?t:[]);return{...s,lineItems:l}}):O("lineItems",e)}:()=>{},isEditing:B}),(0,l.jsx)(f.A,{subtotal:null!=(s=L.subtotal)?s:0,vatRate:null!=(t=L.vatRate)?t:0,vat:null!=(r=L.vat)?r:0,total:null!=(b=L.total)?b:0}),(0,l.jsx)(y.A,{notes:L.notes||"",isEditing:B,onNotesChange:B?e=>O("notes",e):()=>{}}),(0,l.jsx)(g.A,{storeAllocations:L.storeAllocations||[],setStoreAllocations:B?e=>{"function"==typeof e?R(s=>{var t;if(!s)return s;let l=e(null!=(t=s.storeAllocations)?t:[]);return{...s,storeAllocations:l}}):O("storeAllocations",e)}:()=>{},invoiceTotal:null!=(A=L.total)?A:0,isEditing:B,stores:U}),B&&(0,l.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,l.jsx)(x.$,{variant:"default",onClick:()=>{H(!1)},children:"Save"}),(0,l.jsx)(x.$,{variant:"outline",onClick:()=>{H(!1)},children:"Cancel"})]})]}):(0,l.jsx)("div",{children:"Select an invoice to preview"})})]})})})]})}},4183:(e,s,t)=>{Promise.resolve().then(t.bind(t,3281))},4616:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});let l=(0,t(9946).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7223:(e,s,t)=>{"use strict";t.d(s,{a:()=>i});var l=t(8882);function i(e,s,t){return(0,l.P)(e,-s,t)}},7924:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});let l=(0,t(9946).A)("search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},9074:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});let l=(0,t(9946).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[693,281,698,124,727,349,110,441,684,358],()=>s(4183)),_N_E=e.O()}]);